
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../maco/">
      
      
        <link rel="next" href="../../../tutorials/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/x_logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Feature visualization - Xplique</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","UA-132343476-2"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","UA-132343476-2",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=UA-132343476-2",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="dark" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#feature-visualization" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Xplique" class="md-header__button md-logo" aria-label="Xplique" data-md-component="logo">
      
  <img src="../../../assets/x_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Xplique
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Feature visualization
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="dark" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/deel-ai/xplique" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    deel-ai/xplique
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Xplique" class="md-nav__button md-logo" aria-label="Xplique" data-md-component="logo">
      
  <img src="../../../assets/x_logo.png" alt="logo">

    </a>
    Xplique
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/deel-ai/xplique" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    deel-ai/xplique
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Attributions methods
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Attributions methods
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/api_attributions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Description
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Methods
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Methods
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/methods/deconvnet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DeconvNet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/methods/forgrad/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ForGRad
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/methods/grad_cam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grad-CAM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/methods/grad_cam_pp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grad-CAM++
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/methods/gradient_input/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gradient Input
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/methods/guided_backpropagation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Guided Backprop
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/methods/hsic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hsic Attribution Method
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/methods/integrated_gradients/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Integrated Gradient
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/methods/kernel_shap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KernelSHAP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/methods/lime/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lime
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/methods/occlusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Occlusion sensitivity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/methods/rise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rise
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/methods/saliency/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Saliency
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/methods/smoothgrad/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SmoothGrad
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/methods/sobol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sobol Attribution Method
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/methods/square_grad/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SquareGrad
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/methods/vargrad/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    VarGrad
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Metrics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/metrics/api_metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Description
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/metrics/deletion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deletion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/metrics/insertion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Insertion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/metrics/mu_fidelity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MuFidelity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/metrics/avg_stability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AverageStability
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/metrics/average_drop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AverageDropMetric
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/metrics/average_gain/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AverageGainMetric
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/metrics/average_increase/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AverageIncreaseMetric
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/metrics/complexity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Complexity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/metrics/sparseness/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sparseness
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/metrics/random_logit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RandomLogitMetric
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/metrics/model_randomization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ModelRandomizationMetric
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/pytorch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PyTorch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/callable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Callable
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/classification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Classification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/object_detection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Object Detection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/regression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Regression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attributions/semantic_segmentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Semantic Segmentation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Concept based
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Concept based
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/cav/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cav
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/tcav/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tcav
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/craft/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Craft
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Example based
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Example based
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../example_based/api_example_based/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Description
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Similar Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Similar Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../example_based/similar_examples/similar_examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SimilarExamples
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../example_based/similar_examples/cole/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cole
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Counterfactuals
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Counterfactuals
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../example_based/counterfactuals/label_aware_counter_factuals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LabelAwareCounterFactuals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../example_based/counterfactuals/naive_counter_factuals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NaiveCounterFactuals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Semifactuals
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Semifactuals
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../example_based/semifactuals/kleor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kleor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Prototypes
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Prototypes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../example_based/prototypes/api_prototypes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Description
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../example_based/prototypes/proto_greedy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ProtoGreedy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../example_based/prototypes/proto_dash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ProtoDash
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../example_based/prototypes/mmd_critic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MMDCritic
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../example_based/projections/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Projections
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Feature visualization
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Feature visualization
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maco/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Modern Feature Visualization (MaCo)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Feature visualization
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Feature visualization
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Objective" class="md-nav__link">
    <span class="md-ellipsis">
      
        Objective
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Objective" class="md-nav__link">
    <span class="md-ellipsis">
      
        Objective
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="feature-visualization">Feature Visualization<a class="headerlink" href="#feature-visualization" title="Permanent link">&para;</a></h1>
<p><sub>
    <img src="https://upload.wikimedia.org/wikipedia/commons/d/d0/Google_Colaboratory_SVG_Logo.svg" width="20">
</sub> <a href="https://colab.research.google.com/drive/1st43K9AH-UL4eZM1S4QdyrOi7Epa5K8v">View colab tutorial</a></p>
<p>One of the specificities of neural networks is their differentiability. This characteristic allows us to compute gradients, either the gradient of a loss with respect to the parameters, or in the case we are interested in here, of a part of the network with respect to the input.
This gradient then allows us to iteratively modify the input in order to maximize an objective such as a neuron, a channel or a combination of objectives.</p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>If we want to understand individual features, we can search for examples where they have high values
either for a neuron at an individual position, or for an entire channel.
-- <cite><a href="https://distill.pub/2017/feature-visualization">Feature Visualization -- How neural networks build up their understanding of images (2017)</a></cite><sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup></p>
</div>
<p>More precisely, the explanation of a neuron <span class="arithmatex">\(n\)</span> denoted as <span class="arithmatex">\(\phi^{(n)}\)</span> is an input <span class="arithmatex">\(x* \in \mathcal{X}\)</span> such that</p>
<div class="arithmatex">\[ \phi^{(n)} = \underset{x}{arg\ max}\ f(x)^{(n)} - \mathcal{R}(x) \]</div>
<p>with <span class="arithmatex">\(f(x)^{(n)}\)</span> the neuron score for an input <span class="arithmatex">\(x\)</span> and <span class="arithmatex">\(\mathcal{R}(x)\)</span> a regularization term.
In practice it turns out that preconditioning the input in a decorrelated space such as the frequency domain allows to obtain more consistent results and to better formulate the regularization (e.g. by controlling the rate of high frequency and low frequency desired).</p>
<h2 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h2>
<p>Optimize the ten logits of a neural network (we recommend to remove the softmax activation of your network).</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">xplique.features_visualizations</span><span class="w"> </span><span class="kn">import</span> <span class="n">Objective</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">xplique.features_visualizations</span><span class="w"> </span><span class="kn">import</span> <span class="n">optimize</span>

<span class="c1"># load a model...</span>

<span class="c1"># targeting the 10 logits of the layer &#39;logits&#39;</span>
<span class="c1"># we can also target a layer by its index, like -1 for the last layer</span>
<span class="n">logits_obj</span> <span class="o">=</span> <span class="n">Objective</span><span class="o">.</span><span class="n">neuron</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;logits&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<span class="n">images</span><span class="p">,</span> <span class="n">obj_names</span> <span class="o">=</span> <span class="n">optimize</span><span class="p">(</span><span class="n">logits_obj</span><span class="p">)</span> <span class="c1"># 10 images, one for each logits</span>
</code></pre></div>
<p>Create a combination of multiple objectives and aggregate them</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">xplique.features_visualizations</span><span class="w"> </span><span class="kn">import</span> <span class="n">Objective</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">xplique.features_visualizations</span><span class="w"> </span><span class="kn">import</span> <span class="n">optimize</span>

<span class="c1"># load a model...</span>

<span class="c1"># target the first logits neuron</span>
<span class="n">logits_obj</span> <span class="o">=</span> <span class="n">Objective</span><span class="o">.</span><span class="n">neuron</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;logits&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1"># target the third layer</span>
<span class="n">layer_obj</span> <span class="o">=</span> <span class="n">Objective</span><span class="o">.</span><span class="n">layer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;conv2d_1&quot;</span><span class="p">)</span>
<span class="c1"># target the second channel of another layer</span>
<span class="n">channel_obj</span> <span class="o">=</span> <span class="n">Objective</span><span class="o">.</span><span class="n">channel</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;mixed4_2&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># combine the objective</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">logits_obj</span> <span class="o">*</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">layer_obj</span> <span class="o">*</span> <span class="mf">3.0</span> <span class="o">+</span> <span class="n">channel_obj</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">5.0</span><span class="p">)</span>
<span class="n">images</span><span class="p">,</span> <span class="n">obj_names</span> <span class="o">=</span> <span class="n">optimize</span><span class="p">(</span><span class="n">logits_obj</span><span class="p">)</span> <span class="c1"># 1 resulting image</span>
</code></pre></div>
<h2 class="numkdoc" id="Objective"><code>Objective</code><a class="headerlink" href="#Objective" title="Permanent link">&para;</a></h2>
<p>Use to combine several sub-objectives into one.
<br></p>
<h4 class="numkdoc" id="__init__"><code>__init__(<span class='parameter-self'>self</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> model</span>: <span class='parameter-type'> keras.src.engine.training.Model</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> layers</span>: <span class='parameter-type'> List[keras.src.engine.base_layer.Layer]</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> masks</span>: <span class='parameter-type'> List[tensorflow.python.framework.tensor.Tensor]</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> funcs</span>: <span class='parameter-type'> List[Callable]</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> multipliers</span>: <span class='parameter-type'> List[float]</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> names</span>: <span class='parameter-type'> List[str])</span></code><a class="headerlink" href="#__init__" title="Permanent link">&para;</a></h4>
<p><strong>Parameters</strong></p>
<ul>
<li>
<p><strong><span class='parameter-name'>model</span></strong>            : <span class='parameter-type'>keras.src.engine.training.Model</span> </p>
<ul>
<li><p> Model used for optimization.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>layers</span></strong>            : <span class='parameter-type'>List[keras.src.engine.base_layer.Layer]</span> </p>
<ul>
<li><p> A list of the layers output for each sub-objectives.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>masks</span></strong>            : <span class='parameter-type'>List[tensorflow.python.framework.tensor.Tensor]</span> </p>
<ul>
<li><p> A list of masks that will be applied on the targeted layer for each sub-objectives.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>funcs</span></strong>            : <span class='parameter-type'>List[Callable]</span> </p>
<ul>
<li><p> A list of loss functions for each sub-objectives.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>multipliers</span></strong>            : <span class='parameter-type'>List[float]</span> </p>
<ul>
<li><p> A list of multiplication factor for each sub-objectives</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>names</span></strong>            : <span class='parameter-type'>List[str]</span> </p>
<ul>
<li><p> A list of name for each sub-objectives</p> </li>
</ul>
</li>
</ul>
<h4 class="numkdoc" id="channel"><code>channel(<span class='parameter-name'>model</span>: <span class='parameter-type'> keras.src.engine.training.Model</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> layer</span>: <span class='parameter-type'> Union[str, int]</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> channel_ids</span>: <span class='parameter-type'> Union[int, List[int]]</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> multiplier</span>: <span class='parameter-type'> float = 1.0</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> names</span>: <span class='parameter-type'> Union[List[str], str, None] = None)</span></code><a class="headerlink" href="#channel" title="Permanent link">&para;</a></h4>
<p>Util to build an objective to maximise a channel.
<br></p>
<p><strong>Parameters</strong></p>
<ul>
<li>
<p><strong><span class='parameter-name'>model</span></strong>            : <span class='parameter-type'>keras.src.engine.training.Model</span> </p>
<ul>
<li><p> Model used for optimization.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>layer</span></strong>            : <span class='parameter-type'>Union[str, int]</span> </p>
<ul>
<li><p> Index or name of the targeted layer.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>channel_ids</span></strong>            : <span class='parameter-type'>Union[int, List[int]]</span> </p>
<ul>
<li><p> Indexes of the channels to maximise.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>multiplier</span></strong>            : <span class='parameter-type'>float = 1.0</span> </p>
<ul>
<li><p> Multiplication factor of the objectives.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>names</span></strong>            : <span class='parameter-type'>Union[List[str], str, None] = None</span> </p>
<ul>
<li><p> Names for each objectives.</p> </li>
</ul>
</li>
</ul>
<p><strong>Return</strong></p>
<ul>
<li>
<p><strong><span class='parameter-name'>objective</span></strong>            </p>
<ul>
<li><p> An objective containing a sub-objective for each channels.</p> </li>
</ul>
</li>
</ul>
<p><br></p>
<h4 class="numkdoc" id="compile"><code>compile(<span class='parameter-self'>self</span>) -&gt; Tuple[keras.src.engine.training.Model,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Callable,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List[str], Tuple]</code><a class="headerlink" href="#compile" title="Permanent link">&para;</a></h4>
<p>Compile all the sub-objectives into one and return the objects
for the optimisation process.
<br></p>
<p><strong>Return</strong></p>
<ul>
<li>
<p><strong><span class='parameter-name'>model_reconfigured</span></strong>            : <span class='parameter-type'>Tuple[keras.src.engine.training.Model, Callable, List[str], Tuple]</span> </p>
<ul>
<li><p> Model with the outputs needed for the optimization.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>objective_function</span></strong>            : <span class='parameter-type'>Tuple[keras.src.engine.training.Model, Callable, List[str], Tuple]</span> </p>
<ul>
<li><p> Function to call that compute the loss for the objectives.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>names</span></strong>            : <span class='parameter-type'>Tuple[keras.src.engine.training.Model, Callable, List[str], Tuple]</span> </p>
<ul>
<li><p> Names of each objectives.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>input_shape</span></strong>            : <span class='parameter-type'>Tuple[keras.src.engine.training.Model, Callable, List[str], Tuple]</span> </p>
<ul>
<li><p> Shape of the input, one sample for each optimization.</p> </li>
</ul>
</li>
</ul>
<p><br></p>
<h4 class="numkdoc" id="direction"><code>direction(<span class='parameter-name'>model</span>: <span class='parameter-type'> keras.src.engine.training.Model</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> layer</span>: <span class='parameter-type'> Union[str, int]</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> vectors</span>: <span class='parameter-type'> Union[tensorflow.python.framework.tensor.Tensor, List[tensorflow.python.framework.tensor.Tensor]]</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> multiplier</span>: <span class='parameter-type'> float = 1.0</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> cossim_pow</span>: <span class='parameter-type'> float = 2.0</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> names</span>: <span class='parameter-type'> Union[List[str], str, None] = None)</span></code><a class="headerlink" href="#direction" title="Permanent link">&para;</a></h4>
<p>Util to build an objective to maximise a direction of a layer.
<br></p>
<p><strong>Parameters</strong></p>
<ul>
<li>
<p><strong><span class='parameter-name'>model</span></strong>            : <span class='parameter-type'>keras.src.engine.training.Model</span> </p>
<ul>
<li><p> Model used for optimization.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>layer</span></strong>            : <span class='parameter-type'>Union[str, int]</span> </p>
<ul>
<li><p> Index or name of the targeted layer.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>vectors</span></strong>            : <span class='parameter-type'>Union[tensorflow.python.framework.tensor.Tensor, List[tensorflow.python.framework.tensor.Tensor]]</span> </p>
<ul>
<li><p> Direction(s) to optimize.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>multiplier</span></strong>            : <span class='parameter-type'>float = 1.0</span> </p>
<ul>
<li><p> Multiplication factor of the objective.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>cossim_pow</span></strong>            : <span class='parameter-type'>float = 2.0</span> </p>
<ul>
<li><p> Power of the cosine similarity, higher value encourage the objective to care more about the angle of the activations.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>names</span></strong>            : <span class='parameter-type'>Union[List[str], str, None] = None</span> </p>
<ul>
<li><p> A name for each objectives.</p> </li>
</ul>
</li>
</ul>
<p><strong>Return</strong></p>
<ul>
<li>
<p><strong><span class='parameter-name'>objective</span></strong>            </p>
<ul>
<li><p> An objective ready to be compiled</p> </li>
</ul>
</li>
</ul>
<p><br></p>
<h4 class="numkdoc" id="layer"><code>layer(<span class='parameter-name'>model</span>: <span class='parameter-type'> keras.src.engine.training.Model</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> layer</span>: <span class='parameter-type'> Union[str, int]</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> reducer</span>: <span class='parameter-type'> str = 'magnitude'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> multiplier</span>: <span class='parameter-type'> float = 1.0</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> name</span>: <span class='parameter-type'> Optional[str] = None)</span></code><a class="headerlink" href="#layer" title="Permanent link">&para;</a></h4>
<p>Util to build an objective to maximise a layer.
<br></p>
<p><strong>Parameters</strong></p>
<ul>
<li>
<p><strong><span class='parameter-name'>model</span></strong>            : <span class='parameter-type'>keras.src.engine.training.Model</span> </p>
<ul>
<li><p> Model used for optimization.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>layer</span></strong>            : <span class='parameter-type'>Union[str, int]</span> </p>
<ul>
<li><p> Index or name of the targeted layer.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>reducer</span></strong>            : <span class='parameter-type'>str = 'magnitude'</span> </p>
<ul>
<li><p> Type of reduction to apply, 'mean' will optimize the mean value of the layer, 'magnitude' will optimize the mean of the absolute values.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>multiplier</span></strong>            : <span class='parameter-type'>float = 1.0</span> </p>
<ul>
<li><p> Multiplication factor of the objective.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>name</span></strong>            : <span class='parameter-type'>Optional[str] = None</span> </p>
<ul>
<li><p> A name for the objective.</p> </li>
</ul>
</li>
</ul>
<p><strong>Return</strong></p>
<ul>
<li>
<p><strong><span class='parameter-name'>objective</span></strong>            </p>
<ul>
<li><p> An objective ready to be compiled</p> </li>
</ul>
</li>
</ul>
<p><br></p>
<h4 class="numkdoc" id="neuron"><code>neuron(<span class='parameter-name'>model</span>: <span class='parameter-type'> keras.src.engine.training.Model</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> layer</span>: <span class='parameter-type'> Union[str, int]</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> neurons_ids</span>: <span class='parameter-type'> Union[int, List[int]]</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> multiplier</span>: <span class='parameter-type'> float = 1.0</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class='parameter-name'> names</span>: <span class='parameter-type'> Union[List[str], str, None] = None)</span></code><a class="headerlink" href="#neuron" title="Permanent link">&para;</a></h4>
<p>Util to build an objective to maximise a neuron.
<br></p>
<p><strong>Parameters</strong></p>
<ul>
<li>
<p><strong><span class='parameter-name'>model</span></strong>            : <span class='parameter-type'>keras.src.engine.training.Model</span> </p>
<ul>
<li><p> Model used for optimization.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>layer</span></strong>            : <span class='parameter-type'>Union[str, int]</span> </p>
<ul>
<li><p> Index or name of the targeted layer.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>neurons_ids</span></strong>            : <span class='parameter-type'>Union[int, List[int]]</span> </p>
<ul>
<li><p> Indexes of the neurons to maximise.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>multiplier</span></strong>            : <span class='parameter-type'>float = 1.0</span> </p>
<ul>
<li><p> Multiplication factor of the objectives.</p> </li>
</ul>
</li>
<li>
<p><strong><span class='parameter-name'>names</span></strong>            : <span class='parameter-type'>Union[List[str], str, None] = None</span> </p>
<ul>
<li><p> Names for each objectives.</p> </li>
</ul>
</li>
</ul>
<p><strong>Return</strong></p>
<ul>
<li>
<p><strong><span class='parameter-name'>objective</span></strong>            </p>
<ul>
<li><p> An objective containing a sub-objective for each neurons.</p> </li>
</ul>
</li>
</ul>
<p><br></p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p><a href="https://distill.pub/2017/feature-visualization">Feature Visualization -- How neural networks build up their understanding of images (2017)</a>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../js/custom.js"></script>
      
    
  </body>
</html>